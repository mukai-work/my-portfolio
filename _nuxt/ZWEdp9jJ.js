import{_ as x,e as R,h as m,p as H,z as W,c as k,A as Z,j as J,a as p,F as A,B as C,o as _,C as I,t as j,b as Q,k as X,d as K,D as Y}from"./DI4yCYYu.js";const ee=(a,n,o)=>{const r=a[n];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((u,l)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(l.bind(null,new Error("Unknown variable dynamic import: "+n+(n.split("/").length!==o?". Note that variables only represent file names one level deep.":""))))})};function L(){const a=new Uint32Array(4);return crypto.getRandomValues(a),Array.from(a).map(n=>n.toString(36)).join("")}function N(a){let n=0;for(const o of a)n=n*31+o.charCodeAt(0)>>>0;return n===0&&(n=1),()=>(n^=n<<13,n^=n>>>17,n^=n<<5,n>>>0)}function O(a,n){return a()%n}function G(a,n){for(let o=n.length-1;o>0;o--){const r=O(a,o+1);[n[o],n[r]]=[n[r],n[o]]}return n}function te(a,n,o,r){for(let e=0;e<9;e++)if(a[n][e]===r||a[e][o]===r)return!1;const u=Math.floor(n/3)*3,l=Math.floor(o/3)*3;for(let e=0;e<3;e++)for(let t=0;t<3;t++)if(a[u+e][l+t]===r)return!1;return!0}function ne(a,n=2){const o=a.map(l=>[...l]);let r=0;const u=(l=0)=>{if(r>=n)return;if(l===81){r++;return}const e=Math.floor(l/9),t=l%9;if(o[e][t]!==0){u(l+1);return}for(let c=1;c<=9&&r<n;c++)te(o,e,t,c)&&(o[e][t]=c,u(l+1));o[e][t]=0};return u(),r===0?"none":r===1?"unique":"multiple"}function re(){return Array.from({length:9},()=>Array(9).fill(!1))}function w(a){const n=re(),o=Array.from({length:9},()=>Array(10).fill(-1)),r=Array.from({length:9},()=>Array(10).fill(-1)),u=Array.from({length:9},()=>Array(10).fill(-1));for(let l=0;l<9;l++)for(let e=0;e<9;e++){const t=a[l][e];if(t===0)continue;const c=Math.floor(l/3)*3+Math.floor(e/3);if(o[l][t]!==-1?n[l][e]=n[l][o[l][t]]=!0:o[l][t]=e,r[e][t]!==-1?n[l][e]=n[r[e][t]][e]=!0:r[e][t]=l,u[c][t]!==-1){const i=Math.floor(u[c][t]/9),f=u[c][t]%9;n[l][e]=n[i][f]=!0}else u[c][t]=l*9+e}return n}function q(a,n,o,r){for(let e=0;e<9;e++)if(a[n][e]===r||a[e][o]===r)return!1;const u=Math.floor(n/3)*3,l=Math.floor(o/3)*3;for(let e=0;e<3;e++)for(let t=0;t<3;t++)if(a[u+e][l+t]===r)return!1;return!0}function P(a,n,o){const r=[];for(let u=1;u<=9;u++)q(a,n,o,u)&&r.push(u);return r}function oe(a,n){const o=a.map(l=>[...l]);let r=0;for(;;){let l=!1;for(let e=0;e<9;e++)for(let t=0;t<9;t++){if(o[e][t]!==0)continue;const c=P(o,e,t);c.length===1&&n.includes("naked-single")&&(o[e][t]=c[0],r+=1,l=!0)}if(!l){if(n.includes("hidden-single")){for(let e=0;e<27&&!l;e++){const t=[];if(e<9)for(let i=0;i<9;i++)t.push({r:e,c:i});else if(e<18)for(let i=0;i<9;i++)t.push({r:i,c:e-9});else{const i=Math.floor((e-18)/3)*3,f=(e-18)%3*3;for(let y=0;y<3;y++)for(let h=0;h<3;h++)t.push({r:i+y,c:f+h})}const c=Array.from({length:10},()=>[]);for(const{r:i,c:f}of t)if(o[i][f]===0)for(const y of P(o,i,f))c[y].push(i*9+f);for(let i=1;i<=9;i++)if(c[i].length===1){const f=c[i][0],y=Math.floor(f/9),h=f%9;o[y][h]=i,r+=1,l=!0;break}}if(l)continue}break}}return{status:o.every(l=>l.every(e=>e!==0))?"solved":"stuck",rating:r}}function le(a){switch(a){case"easy":return["naked-single","hidden-single"];case"normal":return["naked-single","hidden-single","locked","naked-pair"];case"hard":return["naked-single","hidden-single","locked","naked-pair","hidden-pair","x-wing"];case"expert":return["naked-single","hidden-single","locked","naked-pair","hidden-pair","x-wing","xy-wing"];case"oni":return["naked-single","hidden-single","locked","naked-pair","hidden-pair","x-wing","xy-wing","swordfish"];default:return["naked-single","hidden-single"]}}function se(){return Array.from({length:9},()=>Array(9).fill(0))}function ae(a,n,o,r){for(let e=0;e<9;e++)if(a[n][e]===r||a[e][o]===r)return!1;const u=Math.floor(n/3)*3,l=Math.floor(o/3)*3;for(let e=0;e<3;e++)for(let t=0;t<3;t++)if(a[u+e][l+t]===r)return!1;return!0}function E(a,n,o=0){if(o===81)return!0;const r=Math.floor(o/9),u=o%9;if(a[r][u]!==0)return E(a,n,o+1);const l=G(n,[1,2,3,4,5,6,7,8,9]);for(const e of l)if(ae(a,r,u,e)){if(a[r][u]=e,E(a,n,o+1))return!0;a[r][u]=0}return!1}function ie(a,n,o){const r=a.map(l=>[...l]),u=G(n,Array.from({length:81},(l,e)=>e));for(const l of u){const e=Math.floor(l/9),t=l%9,c=r[e][t];if(r[e][t]=0,ne(r,2)!=="unique"&&(r[e][t]=c),r.flat().filter(f=>f!==0).length<=o)break}return r}async function ue(a){const o=(await ee(Object.assign({"../data/bank/easy.json":()=>x(()=>import("./Cdf7bSM1.js"),[],import.meta.url),"../data/bank/expert.json":()=>x(()=>import("./bQ4ZPnbs.js"),[],import.meta.url),"../data/bank/hard.json":()=>x(()=>import("./DiHkrW1l.js"),[],import.meta.url),"../data/bank/normal.json":()=>x(()=>import("./BKPcU9vJ.js"),[],import.meta.url),"../data/bank/oni.json":()=>x(()=>import("./DEojRT7t.js"),[],import.meta.url)}),`../data/bank/${a}.json`,4)).default,r="bank",u=o[O(N(L()),o.length)],l=u.map(e=>e.map(t=>t!==0));return{grid:u,givens:l,seed:r,difficulty:a,rating:0}}const ce={easy:40,normal:35,hard:30,expert:25,oni:22};async function fe(a){const n=Date.now(),o=L(),r=N(o),u=se();E(u,r);const l=ce[a],e=ie(u,r,l),t=oe(e,le(a));if(t.status!=="solved"||Date.now()-n>2500)return await ue(a);const c=e.map(i=>i.map(f=>f!==0));return{grid:e,givens:c,seed:o,difficulty:a,rating:t.rating}}const de={class:"flex gap-4"},ve={class:"relative",style:{width:"min(92vw,560px)",height:"min(92vw,560px)"}},pe={class:"grid grid-cols-9 grid-rows-9 w-full h-full"},ye=["onClick"],he={class:"flex flex-col items-center gap-4"},ge={class:"grid grid-cols-3 gap-2"},me=["onClick"],be=R({__name:"SudokuBoard",props:{difficulty:{},showErrors:{type:Boolean}},emits:["new"],setup(a,{expose:n,emit:o}){const r=a,u=o;function l(){return Array.from({length:9},()=>Array(9).fill(0))}const e=m(null),t=m(l()),c=m([]),i=m(null),f=m([]),y=m([]),h=m(w(t.value));async function M(){const s=await fe(r.difficulty);e.value=s,t.value=s.grid.map(d=>[...d]),c.value=s.givens.map(d=>[...d]),h.value=w(t.value),i.value=null,f.value=[],y.value=[],u("new",s)}H(()=>r.difficulty,()=>{M()}),n({newGame:M});function U(s,d){i.value={r:s,c:d}}function D(s){if(!i.value)return;const{r:d,c:v}=i.value;if(c.value[d][v]||!q(t.value,d,v,s))return;const g=t.value[d][v];t.value[d][v]=s,f.value.push({r:d,c:v,prev:g,next:s}),y.value=[],h.value=w(t.value)}function V(){if(!i.value)return;const{r:s,c:d}=i.value;if(c.value[s][d])return;const v=t.value[s][d];v!==0&&(t.value[s][d]=0,f.value.push({r:s,c:d,prev:v,next:0}),y.value=[],h.value=w(t.value))}function z(){const s=f.value.pop();s&&(t.value[s.r][s.c]=s.prev,y.value.push(s),h.value=w(t.value))}function $(){const s=y.value.pop();s&&(t.value[s.r][s.c]=s.next,f.value.push(s),h.value=w(t.value))}function F(s){if(!i.value)return;const{r:d,c:v}=i.value;s.key>="1"&&s.key<="9"?D(parseInt(s.key)):s.key==="0"||s.key==="Backspace"?V():s.key==="ArrowUp"||s.key==="w"||s.key==="W"?i.value={r:(d+8)%9,c:v}:s.key==="ArrowDown"||s.key==="s"||s.key==="S"?i.value={r:(d+1)%9,c:v}:s.key==="ArrowLeft"||s.key==="a"||s.key==="A"?i.value={r:d,c:(v+8)%9}:s.key==="ArrowRight"||s.key==="d"||s.key==="D"?i.value={r:d,c:(v+1)%9}:(s.ctrlKey||s.metaKey)&&s.key==="z"?z():(s.ctrlKey||s.metaKey)&&(s.key==="y"||s.shiftKey&&s.key==="Z")&&$()}return W(()=>M()),(s,d)=>(_(),k("div",{class:"inline-block",onKeydown:d[0]||(d[0]=Z(J(()=>{},["prevent"]),["tab"])),onKeydownCapture:F,tabindex:"0"},[p("div",de,[p("div",ve,[p("div",pe,[(_(!0),k(A,null,C(t.value,(v,g)=>(_(),k(A,{key:g},[(_(!0),k(A,null,C(v,(S,b)=>{var T,B;return _(),k("button",{key:b,onClick:Ce=>U(g,b),class:I(["flex items-center justify-center select-none text-lg",(Math.floor(g/3)+Math.floor(b/3))%2===0?"bg-gray-50":"bg-white",g%3===0?"border-t-4 border-t-gray-600":"border-t border-t-gray-400",b%3===0?"border-l-4 border-l-gray-600":"border-l border-l-gray-400",g===8?"border-b-4 border-b-gray-600":"",b===8?"border-r-4 border-r-gray-600":"",((T=i.value)==null?void 0:T.r)===g&&((B=i.value)==null?void 0:B.c)===b?"bg-yellow-200":i.value&&(i.value.r===g||i.value.c===b)?"bg-yellow-100":"",c.value[g][b]?"font-bold":"",r.showErrors&&h.value[g][b]?"bg-red-200":"",i.value&&t.value[i.value.r][i.value.c]!==0&&t.value[i.value.r][i.value.c]===S?"bg-blue-100":""])},j(S||""),11,ye)}),128))],64))),128))])]),p("div",he,[p("div",{class:"flex flex-col gap-2"},[p("button",{class:"p-2 bg-white border rounded w-12 h-12",onClick:V},"消"),p("button",{class:"p-2 bg-white border rounded w-12 h-12",onClick:z},"戻す"),p("button",{class:"p-2 bg-white border rounded w-12 h-12",onClick:$},"やり直し")]),p("div",ge,[(_(),k(A,null,C(9,v=>p("button",{key:v,class:"p-2 bg-white border rounded w-12 h-12 flex items-center justify-center",onClick:g=>D(v)},j(v),9,me)),64))]),p("button",{class:"p-2 bg-blue-500 text-white border rounded w-full",onClick:M},"新規ゲーム")])])],32))}}),ke={class:"min-h-screen p-4 flex flex-col items-center justify-center gap-4"},_e={class:"flex flex-wrap gap-2 items-center justify-center"},we={class:"flex flex-wrap gap-2"},xe=["onClick"],Ae={class:"flex items-center gap-1"},Me={class:"text-sm flex items-center gap-1"},Ee=R({__name:"sudoku",setup(a){const n=m("easy"),o=m(!0),r=m(""),u=[{value:"easy",label:"やさしい"},{value:"normal",label:"ふつう"},{value:"hard",label:"むずかしい"},{value:"expert",label:"エキスパート"},{value:"oni",label:"鬼"}];function l(c){r.value=c.seed}function e(){document.documentElement.classList.toggle("dark")}async function t(){await navigator.clipboard.writeText(r.value)}return(c,i)=>(_(),k("div",ke,[p("div",_e,[p("div",we,[(_(),k(A,null,C(u,f=>p("button",{key:f.value,class:I(["px-2 py-1 border rounded",f.value===n.value?"bg-blue-500 text-white":"bg-white"]),onClick:y=>n.value=f.value},j(f.label),11,xe)),64))]),p("label",Ae,[X(p("input",{type:"checkbox","onUpdate:modelValue":i[0]||(i[0]=f=>o.value=f)},null,512),[[Y,o.value]]),i[1]||(i[1]=K(" エラーハイライト "))]),p("button",{class:"border p-1",onClick:e},"テーマ切替"),p("div",Me,[K(" Seed: "+j(r.value)+" ",1),p("button",{class:"border px-1",onClick:t},"コピー")])]),Q(be,{difficulty:n.value,"show-errors":o.value,onNew:l},null,8,["difficulty","show-errors"])]))}});export{Ee as default};
