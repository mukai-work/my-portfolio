import{e as $,M as B,N as C,h as M,A as S,O as F,c as n,H as _,a as p,t as m,F as h,C as b,o as r,j as y}from"./DrbLrrAD.js";import{u as I}from"./B_S31rTN.js";import"./wSbNHcIL.js";const N={key:0,class:"p-4"},T={class:"text-2xl mb-4"},A={class:"flex gap-4 overflow-x-auto"},E={class:"font-bold mb-2"},H=["onDrop"],L=["onDragstart"],O={key:1,class:"p-4"},G=$({__name:"[id]",async setup(P){let l,f;const v=B(),{data:t}=([l,f]=C(()=>I(`/api/boards/${v.params.id}`,"$PyGKqM0HTI")),l=await l,f(),l),u=M(null),x=async()=>{t.value&&await $fetch(`/api/boards/${t.value.id}`,{method:"PUT",body:t.value})},w=(o,s,a)=>{var e;u.value={columnId:o,cardId:s},(e=a.dataTransfer)==null||e.setData("text/plain",s)},D=o=>{if(!u.value||!t.value)return;const{columnId:s,cardId:a}=u.value,e=t.value.columns.find(i=>i.id===s),c=t.value.columns.find(i=>i.id===o);if(!e||!c)return;const g=e.cards.findIndex(i=>i.id===a);if(g===-1)return;const[k]=e.cards.splice(g,1);c.cards.push(k),u.value=null,x()};let d=null;return S(()=>{d=new EventSource(`/api/boards/${v.params.id}/stream`),d.onmessage=o=>{t.value=JSON.parse(o.data)}}),F(()=>{d==null||d.close()}),(o,s)=>_(t)?(r(),n("div",N,[p("h1",T,m(_(t).name),1),p("div",A,[(r(!0),n(h,null,b(_(t).columns,a=>(r(),n("div",{key:a.id,class:"w-64 bg-gray-100 p-2 rounded"},[p("h2",E,m(a.name),1),p("ul",{onDragover:s[0]||(s[0]=y(()=>{},["prevent"])),onDrop:y(e=>D(a.id),["prevent"])},[(r(!0),n(h,null,b(a.cards,e=>(r(),n("li",{key:e.id,class:"bg-white p-2 mb-2 rounded shadow",draggable:"true",onDragstart:c=>w(a.id,e.id,c)},m(e.title),41,L))),128))],40,H)]))),128))])])):(r(),n("div",O,"Loading..."))}});export{G as default};
