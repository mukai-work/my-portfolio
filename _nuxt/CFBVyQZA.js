import{l as P,h as y,m as E,n as I,q as N,s as _,x as L,e as U,c as T,a as p,k as V,j as x,v as j,t as B,i as q,o as A,y as F}from"./3ksz-kXm.js";import{i as H}from"./wSbNHcIL.js";function $(e,n){if(typeof e!="string")throw new TypeError("argument str must be a string");const t={},o=n||{},a=o.decode||z;let r=0;for(;r<e.length;){const i=e.indexOf("=",r);if(i===-1)break;let s=e.indexOf(";",r);if(s===-1)s=e.length;else if(s<i){r=e.lastIndexOf(";",i-1)+1;continue}const l=e.slice(r,i).trim();if(o!=null&&o.filter&&!(o!=null&&o.filter(l))){r=s+1;continue}if(t[l]===void 0){let f=e.slice(i+1,s).trim();f.codePointAt(0)===34&&(f=f.slice(1,-1)),t[l]=J(f,a)}r=s+1}return t}function z(e){return e.includes("%")?decodeURIComponent(e):e}function J(e,n){try{return n(e)}catch{return e}}const g=/^[\u0009\u0020-\u007E\u0080-\u00FF]+$/;function O(e,n,t){const o=t||{},a=o.encode||encodeURIComponent;if(typeof a!="function")throw new TypeError("option encode is invalid");if(!g.test(e))throw new TypeError("argument name is invalid");const r=a(n);if(r&&!g.test(r))throw new TypeError("argument val is invalid");let i=e+"="+r;if(o.maxAge!==void 0&&o.maxAge!==null){const s=o.maxAge-0;if(Number.isNaN(s)||!Number.isFinite(s))throw new TypeError("option maxAge is invalid");i+="; Max-Age="+Math.floor(s)}if(o.domain){if(!g.test(o.domain))throw new TypeError("option domain is invalid");i+="; Domain="+o.domain}if(o.path){if(!g.test(o.path))throw new TypeError("option path is invalid");i+="; Path="+o.path}if(o.expires){if(!X(o.expires)||Number.isNaN(o.expires.valueOf()))throw new TypeError("option expires is invalid");i+="; Expires="+o.expires.toUTCString()}if(o.httpOnly&&(i+="; HttpOnly"),o.secure&&(i+="; Secure"),o.priority)switch(typeof o.priority=="string"?o.priority.toLowerCase():o.priority){case"low":{i+="; Priority=Low";break}case"medium":{i+="; Priority=Medium";break}case"high":{i+="; Priority=High";break}default:throw new TypeError("option priority is invalid")}if(o.sameSite)switch(typeof o.sameSite=="string"?o.sameSite.toLowerCase():o.sameSite){case!0:{i+="; SameSite=Strict";break}case"lax":{i+="; SameSite=Lax";break}case"strict":{i+="; SameSite=Strict";break}case"none":{i+="; SameSite=None";break}default:throw new TypeError("option sameSite is invalid")}return o.partitioned&&(i+="; Partitioned"),i}function X(e){return Object.prototype.toString.call(e)==="[object Date]"||e instanceof Date}function u(e){if(typeof e!="object")return e;var n,t,o=Object.prototype.toString.call(e);if(o==="[object Object]"){if(e.constructor!==Object&&typeof e.constructor=="function"){t=new e.constructor;for(n in e)e.hasOwnProperty(n)&&t[n]!==e[n]&&(t[n]=u(e[n]))}else{t={};for(n in e)n==="__proto__"?Object.defineProperty(t,n,{value:u(e[n]),configurable:!0,enumerable:!0,writable:!0}):t[n]=u(e[n])}return t}if(o==="[object Array]"){for(n=e.length,t=Array(n);n--;)t[n]=u(e[n]);return t}return o==="[object Set]"?(t=new Set,e.forEach(function(a){t.add(u(a))}),t):o==="[object Map]"?(t=new Map,e.forEach(function(a,r){t.set(u(r),u(a))}),t):o==="[object Date]"?new Date(+e):o==="[object RegExp]"?(t=new RegExp(e.source,e.flags),t.lastIndex=e.lastIndex,t):o==="[object DataView]"?new e.constructor(u(e.buffer)):o==="[object ArrayBuffer]"?e.slice(0):o.slice(-6)==="Array]"?new e.constructor(e):e}const Y={path:"/",watch:!0,decode:e=>P(decodeURIComponent(e)),encode:e=>encodeURIComponent(typeof e=="string"?e:JSON.stringify(e))},b=window.cookieStore;function G(e,n){var f;const t={...Y,...n};t.filter??(t.filter=c=>c===e);const o=D(t)||{};let a;t.maxAge!==void 0?a=t.maxAge*1e3:t.expires&&(a=t.expires.getTime()-Date.now());const r=a!==void 0&&a<=0,i=r||o[e]===void 0||o[e]===null,s=u(r?void 0:o[e]??((f=t.default)==null?void 0:f.call(t))),l=a&&!r?Z(s,a,t.watch&&t.watch!=="shallow"):y(s);{let c=null;try{!b&&typeof BroadcastChannel<"u"&&(c=new BroadcastChannel(`nuxt:cookies:${e}`))}catch{}const m=(d=!1)=>{!d&&(t.readonly||H(l.value,o[e]))||(Q(e,l.value,t),o[e]=u(l.value),c==null||c.postMessage({value:t.encode(l.value)}))},k=d=>{var h;const w=d.refresh?(h=D(t))==null?void 0:h[e]:t.decode(d.value);v=!0,l.value=w,o[e]=u(w),L(()=>{v=!1})};let v=!1;const C=!!N();if(C&&E(()=>{v=!0,m(),c==null||c.close()}),b){const d=w=>{const h=w.changed.find(S=>S.name===e),M=w.deleted.find(S=>S.name===e);h&&k({value:h.value}),M&&k({value:null})};b.addEventListener("change",d),C&&E(()=>b.removeEventListener("change",d))}else c&&(c.onmessage=({data:d})=>k(d));t.watch&&I(l,()=>{v||m()},{deep:t.watch!=="shallow"}),i&&m(i)}return l}function D(e={}){return $(document.cookie,e)}function K(e,n,t={}){return n==null?O(e,n,{...t,maxAge:-1}):O(e,n,t)}function Q(e,n,t={}){document.cookie=K(e,n,t)}const R=2147483647;function Z(e,n,t){let o,a,r=0;const i=t?y(e):{value:e};return N()&&E(()=>{a==null||a(),clearTimeout(o)}),_((s,l)=>{t&&(a=I(i,l));function f(){r=0,clearTimeout(o);const c=n-r,m=c<R?c:R;o=setTimeout(()=>{if(r+=m,r<n)return f();i.value=void 0,l()},m)}return{get(){return s(),i.value},set(c){f(),i.value=c,l()}}})}const W={class:"max-w-md mx-auto p-8"},ee={key:0,class:"text-red-500 text-sm"},ie=U({__name:"login",setup(e){const n=y(""),t=y(""),o=y("");async function a(){try{const r=await $fetch("/api/login",{method:"POST",body:{email:n.value,password:t.value}}),i=G("token");i.value=r.token,await F("/board")}catch{o.value="メールアドレスまたはパスワードが正しくありません。"}}return(r,i)=>(A(),T("div",W,[i[3]||(i[3]=p("h1",{class:"text-2xl font-bold text-center mb-6"},"ログイン",-1)),p("form",{onSubmit:q(a,["prevent"]),class:"space-y-4"},[p("div",null,[x(p("input",{"onUpdate:modelValue":i[0]||(i[0]=s=>n.value=s),type:"email",placeholder:"メールアドレス",class:"border rounded w-full p-2"},null,512),[[j,n.value]])]),p("div",null,[x(p("input",{"onUpdate:modelValue":i[1]||(i[1]=s=>t.value=s),type:"password",placeholder:"パスワード",class:"border rounded w-full p-2"},null,512),[[j,t.value]])]),o.value?(A(),T("div",ee,B(o.value),1)):V("",!0),i[2]||(i[2]=p("button",{type:"submit",class:"w-full bg-blue-500 text-white py-2 rounded"}," ログイン ",-1))],32)]))}});export{ie as default};
