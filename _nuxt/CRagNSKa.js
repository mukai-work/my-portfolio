import{_ as x,e as R,h,z as W,p as Z,A as J,c as y,B as Q,j as X,a as b,l as Y,F as A,C as M,o as k,D as I,t as j,b as ee,k as te,d as K,E as re}from"./D5zb0sa3.js";const ne=(i,r,o)=>{const n=i[r];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((u,a)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(a.bind(null,new Error("Unknown variable dynamic import: "+r+(r.split("/").length!==o?". Note that variables only represent file names one level deep.":""))))})};function N(){const i=new Uint32Array(4);return crypto.getRandomValues(i),Array.from(i).map(r=>r.toString(36)).join("")}function L(i){let r=0;for(const o of i)r=r*31+o.charCodeAt(0)>>>0;return r===0&&(r=1),()=>(r^=r<<13,r^=r>>>17,r^=r<<5,r>>>0)}function O(i,r){return i()%r}function G(i,r){for(let o=r.length-1;o>0;o--){const n=O(i,o+1);[r[o],r[n]]=[r[n],r[o]]}return r}function oe(i,r,o,n){for(let e=0;e<9;e++)if(i[r][e]===n||i[e][o]===n)return!1;const u=Math.floor(r/3)*3,a=Math.floor(o/3)*3;for(let e=0;e<3;e++)for(let t=0;t<3;t++)if(i[u+e][a+t]===n)return!1;return!0}function le(i,r=2){const o=i.map(a=>[...a]);let n=0;const u=(a=0)=>{if(n>=r)return;if(a===81){n++;return}const e=Math.floor(a/9),t=a%9;if(o[e][t]!==0){u(a+1);return}for(let c=1;c<=9&&n<r;c++)oe(o,e,t,c)&&(o[e][t]=c,u(a+1));o[e][t]=0};return u(),n===0?"none":n===1?"unique":"multiple"}function ae(){return Array.from({length:9},()=>Array(9).fill(!1))}function w(i){const r=ae(),o=Array.from({length:9},()=>Array(10).fill(-1)),n=Array.from({length:9},()=>Array(10).fill(-1)),u=Array.from({length:9},()=>Array(10).fill(-1));for(let a=0;a<9;a++)for(let e=0;e<9;e++){const t=i[a][e];if(t===0)continue;const c=Math.floor(a/3)*3+Math.floor(e/3);if(o[a][t]!==-1?r[a][e]=r[a][o[a][t]]=!0:o[a][t]=e,n[e][t]!==-1?r[a][e]=r[n[e][t]][e]=!0:n[e][t]=a,u[c][t]!==-1){const s=Math.floor(u[c][t]/9),f=u[c][t]%9;r[a][e]=r[s][f]=!0}else u[c][t]=a*9+e}return r}function q(i,r,o,n){for(let e=0;e<9;e++)if(i[r][e]===n||i[e][o]===n)return!1;const u=Math.floor(r/3)*3,a=Math.floor(o/3)*3;for(let e=0;e<3;e++)for(let t=0;t<3;t++)if(i[u+e][a+t]===n)return!1;return!0}function P(i,r,o){const n=[];for(let u=1;u<=9;u++)q(i,r,o,u)&&n.push(u);return n}function se(i,r){const o=i.map(a=>[...a]);let n=0;for(;;){let a=!1;for(let e=0;e<9;e++)for(let t=0;t<9;t++){if(o[e][t]!==0)continue;const c=P(o,e,t);c.length===1&&r.includes("naked-single")&&(o[e][t]=c[0],n+=1,a=!0)}if(!a){if(r.includes("hidden-single")){for(let e=0;e<27&&!a;e++){const t=[];if(e<9)for(let s=0;s<9;s++)t.push({r:e,c:s});else if(e<18)for(let s=0;s<9;s++)t.push({r:s,c:e-9});else{const s=Math.floor((e-18)/3)*3,f=(e-18)%3*3;for(let p=0;p<3;p++)for(let m=0;m<3;m++)t.push({r:s+p,c:f+m})}const c=Array.from({length:10},()=>[]);for(const{r:s,c:f}of t)if(o[s][f]===0)for(const p of P(o,s,f))c[p].push(s*9+f);for(let s=1;s<=9;s++)if(c[s].length===1){const f=c[s][0],p=Math.floor(f/9),m=f%9;o[p][m]=s,n+=1,a=!0;break}}if(a)continue}break}}return{status:o.every(a=>a.every(e=>e!==0))?"solved":"stuck",rating:n}}function ie(i){switch(i){case"easy":return["naked-single","hidden-single"];case"normal":return["naked-single","hidden-single","locked","naked-pair"];case"hard":return["naked-single","hidden-single","locked","naked-pair","hidden-pair","x-wing"];case"expert":return["naked-single","hidden-single","locked","naked-pair","hidden-pair","x-wing","xy-wing"];case"oni":return["naked-single","hidden-single","locked","naked-pair","hidden-pair","x-wing","xy-wing","swordfish"];default:return["naked-single","hidden-single"]}}function ue(){return Array.from({length:9},()=>Array(9).fill(0))}function ce(i,r,o,n){for(let e=0;e<9;e++)if(i[r][e]===n||i[e][o]===n)return!1;const u=Math.floor(r/3)*3,a=Math.floor(o/3)*3;for(let e=0;e<3;e++)for(let t=0;t<3;t++)if(i[u+e][a+t]===n)return!1;return!0}function E(i,r,o=0){if(o===81)return!0;const n=Math.floor(o/9),u=o%9;if(i[n][u]!==0)return E(i,r,o+1);const a=G(r,[1,2,3,4,5,6,7,8,9]);for(const e of a)if(ce(i,n,u,e)){if(i[n][u]=e,E(i,r,o+1))return!0;i[n][u]=0}return!1}function fe(i,r,o){const n=i.map(a=>[...a]),u=G(r,Array.from({length:81},(a,e)=>e));for(const a of u){const e=Math.floor(a/9),t=a%9,c=n[e][t];if(n[e][t]=0,le(n,2)!=="unique"&&(n[e][t]=c),n.flat().filter(f=>f!==0).length<=o)break}return n}async function de(i){const o=(await ne(Object.assign({"../data/bank/easy.json":()=>x(()=>import("./Cdf7bSM1.js"),[],import.meta.url),"../data/bank/expert.json":()=>x(()=>import("./bQ4ZPnbs.js"),[],import.meta.url),"../data/bank/hard.json":()=>x(()=>import("./DiHkrW1l.js"),[],import.meta.url),"../data/bank/normal.json":()=>x(()=>import("./BKPcU9vJ.js"),[],import.meta.url),"../data/bank/oni.json":()=>x(()=>import("./DEojRT7t.js"),[],import.meta.url)}),`../data/bank/${i}.json`,4)).default,n="bank",u=o[O(L(N()),o.length)],a=u.map(e=>e.map(t=>t!==0));return{grid:u,givens:a,seed:n,difficulty:i,rating:0}}const ve={easy:40,normal:35,hard:30,expert:25,oni:22};async function be(i){const r=Date.now(),o=N(),n=L(o),u=ue();E(u,n);const a=ve[i],e=fe(u,n,a),t=se(e,ie(i));if(t.status!=="solved"||Date.now()-r>2500)return await de(i);const c=e.map(s=>s.map(f=>f!==0));return{grid:e,givens:c,seed:o,difficulty:i,rating:t.rating}}const pe={class:"flex gap-4"},me={class:"relative",style:{width:"min(92vw,560px)",height:"min(92vw,560px)"}},ge={class:"grid grid-cols-9 grid-rows-9 w-full h-full border-[3px] border-[var(--fg)]"},he=["onClick"],ye={key:0,class:"absolute inset-0 flex items-center justify-center bg-black/20 text-4xl font-bold text-green-600"},ke={class:"flex flex-col items-center gap-4"},_e={class:"grid grid-cols-3 gap-2"},we=["onClick"],xe=R({__name:"SudokuBoard",props:{difficulty:{},showErrors:{type:Boolean}},emits:["new"],setup(i,{expose:r,emit:o}){const n=i,u=o;function a(){return Array.from({length:9},()=>Array(9).fill(0))}const e=h(null),t=h(a()),c=h([]),s=h(null),f=h([]),p=h([]),m=h(w(t.value)),U=W(()=>t.value.every(l=>l.every(d=>d!==0)));async function C(){const l=await be(n.difficulty);e.value=l,t.value=l.grid.map(d=>[...d]),c.value=l.givens.map(d=>[...d]),m.value=w(t.value),s.value=null,f.value=[],p.value=[],u("new",l)}Z(()=>n.difficulty,()=>{C()}),r({newGame:C});function F(l,d){s.value={r:l,c:d}}function D(l){if(!s.value)return;const{r:d,c:v}=s.value;if(c.value[d][v]||!q(t.value,d,v,l))return;const g=t.value[d][v];t.value[d][v]=l,f.value.push({r:d,c:v,prev:g,next:l}),p.value=[],m.value=w(t.value)}function V(){if(!s.value)return;const{r:l,c:d}=s.value;if(c.value[l][d])return;const v=t.value[l][d];v!==0&&(t.value[l][d]=0,f.value.push({r:l,c:d,prev:v,next:0}),p.value=[],m.value=w(t.value))}function z(){const l=f.value.pop();l&&(t.value[l.r][l.c]=l.prev,p.value.push(l),m.value=w(t.value))}function $(){const l=p.value.pop();l&&(t.value[l.r][l.c]=l.next,f.value.push(l),m.value=w(t.value))}function H(l){if(!s.value)return;const{r:d,c:v}=s.value;l.key>="1"&&l.key<="9"?D(parseInt(l.key)):l.key==="0"||l.key==="Backspace"?V():l.key==="ArrowUp"||l.key==="w"||l.key==="W"?s.value={r:(d+8)%9,c:v}:l.key==="ArrowDown"||l.key==="s"||l.key==="S"?s.value={r:(d+1)%9,c:v}:l.key==="ArrowLeft"||l.key==="a"||l.key==="A"?s.value={r:d,c:(v+8)%9}:l.key==="ArrowRight"||l.key==="d"||l.key==="D"?s.value={r:d,c:(v+1)%9}:(l.ctrlKey||l.metaKey)&&l.key==="z"?z():(l.ctrlKey||l.metaKey)&&(l.key==="y"||l.shiftKey&&l.key==="Z")&&$()}return J(()=>C()),(l,d)=>(k(),y("div",{class:"inline-block",onKeydown:d[0]||(d[0]=Q(X(()=>{},["prevent"]),["tab"])),onKeydownCapture:H,tabindex:"0"},[b("div",pe,[b("div",me,[b("div",ge,[(k(!0),y(A,null,M(t.value,(v,g)=>(k(),y(A,{key:g},[(k(!0),y(A,null,M(v,(S,_)=>{var T,B;return k(),y("button",{key:_,onClick:Ve=>F(g,_),class:I(["flex items-center justify-center select-none text-lg bg-[var(--surface)]",(g+1)%3===0?"border-b-[3px] border-b-[var(--fg)]":"border-b border-b-[var(--border)]",(_+1)%3===0?"border-r-[3px] border-r-[var(--fg)]":"border-r border-r-[var(--border)]",s.value&&(s.value.r===g||s.value.c===_)?"bg-blue-50 dark:bg-blue-900":"",((T=s.value)==null?void 0:T.r)===g&&((B=s.value)==null?void 0:B.c)===_?"bg-blue-200 dark:bg-blue-700":"",c.value[g][_]?"font-bold":"",n.showErrors&&m.value[g][_]?"bg-red-200 dark:bg-red-700":"",s.value&&t.value[s.value.r][s.value.c]!==0&&t.value[s.value.r][s.value.c]===S?"bg-blue-100 dark:bg-blue-700":""])},j(S||""),11,he)}),128))],64))),128))]),U.value?(k(),y("div",ye," Done! ")):Y("",!0)]),b("div",ke,[b("div",{class:"flex flex-col gap-2"},[b("button",{class:"p-2 bg-[var(--surface)] border border-[var(--border)] rounded w-12 h-12",onClick:V},"消"),b("button",{class:"p-2 bg-[var(--surface)] border border-[var(--border)] rounded w-12 h-12",onClick:z},"戻す"),b("button",{class:"p-2 bg-[var(--surface)] border border-[var(--border)] rounded w-12 h-12",onClick:$},"やり直し")]),b("div",_e,[(k(),y(A,null,M(9,v=>b("button",{key:v,class:"p-2 bg-[var(--surface)] border border-[var(--border)] rounded w-12 h-12 flex items-center justify-center",onClick:g=>D(v)},j(v),9,we)),64))]),b("button",{class:"p-2 bg-blue-500 dark:bg-blue-600 text-white border border-[var(--border)] rounded w-full",onClick:C},"新規ゲーム")])])],32))}}),Ae={class:"min-h-screen p-4 flex flex-col items-center justify-center gap-4"},Ce={class:"flex flex-wrap gap-2 items-center justify-center"},Me={class:"flex flex-wrap gap-2"},je=["onClick"],Ee={class:"flex items-center gap-1"},De={class:"text-sm flex items-center gap-1"},$e=R({__name:"sudoku",setup(i){const r=h("easy"),o=h(!0),n=h(""),u=[{value:"easy",label:"やさしい"},{value:"normal",label:"ふつう"},{value:"hard",label:"むずかしい"},{value:"expert",label:"エキスパート"},{value:"oni",label:"鬼"}];function a(c){n.value=c.seed}function e(){const c=document.documentElement,s=c.getAttribute("data-theme");c.setAttribute("data-theme",s==="dark"?"light":"dark")}async function t(){await navigator.clipboard.writeText(n.value)}return(c,s)=>(k(),y("div",Ae,[b("div",Ce,[b("div",Me,[(k(),y(A,null,M(u,f=>b("button",{key:f.value,class:I(["px-2 py-1 border border-[var(--border)] rounded",f.value===r.value?"bg-blue-500 text-white dark:bg-blue-600":"bg-[var(--surface)]"]),onClick:p=>r.value=f.value},j(f.label),11,je)),64))]),b("label",Ee,[te(b("input",{type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=f=>o.value=f)},null,512),[[re,o.value]]),s[1]||(s[1]=K(" エラーハイライト "))]),b("button",{class:"border border-[var(--border)] p-1 bg-[var(--surface)]",onClick:e},"テーマ切替"),b("div",De,[K(" Seed: "+j(n.value)+" ",1),b("button",{class:"border border-[var(--border)] px-1 bg-[var(--surface)]",onClick:t},"コピー")])]),ee(xe,{difficulty:r.value,"show-errors":o.value,onNew:a},null,8,["difficulty","show-errors"])]))}});export{$e as default};
