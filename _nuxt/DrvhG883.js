import{h as _,y as B,e as j,z as A,c as m,a as d,F as b,A as k,B as v,C,t as x,o as h}from"./DJRvlybp.js";const V=()=>{const e=_([]),n=_([]),t=_(null);function o(){const{puzzle:i,solution:c}=F();e.value=i.map(a=>a.map(r=>({value:r===0?null:r,given:r!==0}))),n.value=c,t.value=null}function s(i,c){t.value={r:i,c}}function l(i){if(!t.value)return;const c=e.value[t.value.r][t.value.c];c.given||(c.value=i)}function u(){if(!t.value)return;const i=e.value[t.value.r][t.value.c];i.given||(i.value=null)}const f=B(()=>e.value.length>0&&e.value.every((i,c)=>i.every((a,r)=>a.value===n.value[c][r])));return{grid:e,selected:t,select:s,setValue:l,clear:u,newGame:o,isSolved:f}};function F(){const e=Array.from({length:9},()=>Array(9).fill(0));w(e);const n=e.map(o=>[...o]);return{puzzle:G(e),solution:n}}function M(e){for(let n=e.length-1;n>0;n--){const t=Math.floor(Math.random()*(n+1));[e[n],e[t]]=[e[t],e[n]]}return e}function w(e,n=0){if(n===81)return!0;const t=Math.floor(n/9),o=n%9;if(e[t][o]!==0)return w(e,n+1);const s=M([1,2,3,4,5,6,7,8,9]);for(const l of s)if(S(e,t,o,l)){if(e[t][o]=l,w(e,n+1))return!0;e[t][o]=0}return!1}function S(e,n,t,o){for(let u=0;u<9;u++)if(e[n][u]===o||e[u][t]===o)return!1;const s=Math.floor(n/3)*3,l=Math.floor(t/3)*3;for(let u=0;u<3;u++)for(let f=0;f<3;f++)if(e[s+u][l+f]===o)return!1;return!0}function z(e,n=0,t=0){if(t>1)return t;if(n===81)return t+1;const o=Math.floor(n/9),s=n%9;if(e[o][s]!==0)return z(e,n+1,t);for(let l=1;l<=9&&t<2;l++)S(e,o,s,l)&&(e[o][s]=l,t=z(e,n+1,t));return e[o][s]=0,t}function G(e){const n=e.map(o=>[...o]),t=M(Array.from({length:81},(o,s)=>s));for(const o of t){const s=Math.floor(o/9),l=o%9,u=n[s][l];n[s][l]=0;const f=n.map(i=>[...i]);z(f)!==1&&(n[s][l]=u)}return n}const N={class:"min-h-screen bg-gray-100 p-4"},$={class:"max-w-md mx-auto"},D={class:"grid grid-cols-9 gap-0 border-2 border-gray-700"},E=["onClick"],L={class:"mt-4 grid grid-cols-3 gap-2"},q={class:"col-span-3 grid grid-cols-9 gap-1"},H=["onClick"],K=j({__name:"sudoku",setup(e){const{grid:n,selected:t,select:o,setValue:s,clear:l,newGame:u,isSolved:f}=V();function i(c,a,r){var g,p;return["w-8 h-8 border border-gray-400 flex items-center justify-center text-sm",r.given?"bg-gray-200":"bg-white",((g=t.value)==null?void 0:g.r)===c&&((p=t.value)==null?void 0:p.c)===a?"bg-yellow-200":"",c%3===0?"border-t-2":"",a%3===0?"border-l-2":"",c===8?"border-b-2":"",a===8?"border-r-2":""]}return A(()=>u()),(c,a)=>(h(),m("main",N,[d("div",$,[a[2]||(a[2]=d("h1",{class:"text-2xl font-bold text-center text-orange-600 mb-4"},"ナンプレ",-1)),d("div",D,[(h(!0),m(b,null,k(v(n),(r,g)=>(h(),m("div",{key:g,class:"contents"},[(h(!0),m(b,null,k(r,(p,y)=>(h(),m("button",{key:y,onClick:I=>v(o)(g,y),class:C(i(g,y,p))},x(p.value??""),11,E))),128))]))),128))]),d("div",L,[d("div",q,[(h(),m(b,null,k(9,r=>d("button",{key:r,class:"p-2 bg-white rounded shadow",onClick:g=>v(s)(r)},x(r),9,H)),64))]),d("button",{class:"p-2 bg-white rounded shadow",onClick:a[0]||(a[0]=(...r)=>v(l)&&v(l)(...r))},"消す"),d("button",{class:"p-2 bg-white rounded shadow",onClick:a[1]||(a[1]=(...r)=>v(u)&&v(u)(...r))},"新規"),d("div",{class:C(["p-2 flex items-center justify-center col-span-1",v(f)?"text-green-600 font-semibold":"text-gray-500"])},x(v(f)?"完成！":""),3)])])]))}});export{K as default};
