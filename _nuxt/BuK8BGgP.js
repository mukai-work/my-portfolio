import{_ as x,e as R,h as y,p as H,z as W,c as k,A as Z,j as J,a as b,F as A,B as C,o as _,C as I,t as j,b as Q,k as X,d as K,D as Y}from"./fJbj6orS.js";const ee=(i,r,o)=>{const n=i[r];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((u,l)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(l.bind(null,new Error("Unknown variable dynamic import: "+r+(r.split("/").length!==o?". Note that variables only represent file names one level deep.":""))))})};function L(){const i=new Uint32Array(4);return crypto.getRandomValues(i),Array.from(i).map(r=>r.toString(36)).join("")}function N(i){let r=0;for(const o of i)r=r*31+o.charCodeAt(0)>>>0;return r===0&&(r=1),()=>(r^=r<<13,r^=r>>>17,r^=r<<5,r>>>0)}function O(i,r){return i()%r}function G(i,r){for(let o=r.length-1;o>0;o--){const n=O(i,o+1);[r[o],r[n]]=[r[n],r[o]]}return r}function te(i,r,o,n){for(let e=0;e<9;e++)if(i[r][e]===n||i[e][o]===n)return!1;const u=Math.floor(r/3)*3,l=Math.floor(o/3)*3;for(let e=0;e<3;e++)for(let t=0;t<3;t++)if(i[u+e][l+t]===n)return!1;return!0}function re(i,r=2){const o=i.map(l=>[...l]);let n=0;const u=(l=0)=>{if(n>=r)return;if(l===81){n++;return}const e=Math.floor(l/9),t=l%9;if(o[e][t]!==0){u(l+1);return}for(let c=1;c<=9&&n<r;c++)te(o,e,t,c)&&(o[e][t]=c,u(l+1));o[e][t]=0};return u(),n===0?"none":n===1?"unique":"multiple"}function ne(){return Array.from({length:9},()=>Array(9).fill(!1))}function w(i){const r=ne(),o=Array.from({length:9},()=>Array(10).fill(-1)),n=Array.from({length:9},()=>Array(10).fill(-1)),u=Array.from({length:9},()=>Array(10).fill(-1));for(let l=0;l<9;l++)for(let e=0;e<9;e++){const t=i[l][e];if(t===0)continue;const c=Math.floor(l/3)*3+Math.floor(e/3);if(o[l][t]!==-1?r[l][e]=r[l][o[l][t]]=!0:o[l][t]=e,n[e][t]!==-1?r[l][e]=r[n[e][t]][e]=!0:n[e][t]=l,u[c][t]!==-1){const a=Math.floor(u[c][t]/9),f=u[c][t]%9;r[l][e]=r[a][f]=!0}else u[c][t]=l*9+e}return r}function q(i,r,o,n){for(let e=0;e<9;e++)if(i[r][e]===n||i[e][o]===n)return!1;const u=Math.floor(r/3)*3,l=Math.floor(o/3)*3;for(let e=0;e<3;e++)for(let t=0;t<3;t++)if(i[u+e][l+t]===n)return!1;return!0}function P(i,r,o){const n=[];for(let u=1;u<=9;u++)q(i,r,o,u)&&n.push(u);return n}function oe(i,r){const o=i.map(l=>[...l]);let n=0;for(;;){let l=!1;for(let e=0;e<9;e++)for(let t=0;t<9;t++){if(o[e][t]!==0)continue;const c=P(o,e,t);c.length===1&&r.includes("naked-single")&&(o[e][t]=c[0],n+=1,l=!0)}if(!l){if(r.includes("hidden-single")){for(let e=0;e<27&&!l;e++){const t=[];if(e<9)for(let a=0;a<9;a++)t.push({r:e,c:a});else if(e<18)for(let a=0;a<9;a++)t.push({r:a,c:e-9});else{const a=Math.floor((e-18)/3)*3,f=(e-18)%3*3;for(let p=0;p<3;p++)for(let g=0;g<3;g++)t.push({r:a+p,c:f+g})}const c=Array.from({length:10},()=>[]);for(const{r:a,c:f}of t)if(o[a][f]===0)for(const p of P(o,a,f))c[p].push(a*9+f);for(let a=1;a<=9;a++)if(c[a].length===1){const f=c[a][0],p=Math.floor(f/9),g=f%9;o[p][g]=a,n+=1,l=!0;break}}if(l)continue}break}}return{status:o.every(l=>l.every(e=>e!==0))?"solved":"stuck",rating:n}}function le(i){switch(i){case"easy":return["naked-single","hidden-single"];case"normal":return["naked-single","hidden-single","locked","naked-pair"];case"hard":return["naked-single","hidden-single","locked","naked-pair","hidden-pair","x-wing"];case"expert":return["naked-single","hidden-single","locked","naked-pair","hidden-pair","x-wing","xy-wing"];case"oni":return["naked-single","hidden-single","locked","naked-pair","hidden-pair","x-wing","xy-wing","swordfish"];default:return["naked-single","hidden-single"]}}function ae(){return Array.from({length:9},()=>Array(9).fill(0))}function se(i,r,o,n){for(let e=0;e<9;e++)if(i[r][e]===n||i[e][o]===n)return!1;const u=Math.floor(r/3)*3,l=Math.floor(o/3)*3;for(let e=0;e<3;e++)for(let t=0;t<3;t++)if(i[u+e][l+t]===n)return!1;return!0}function E(i,r,o=0){if(o===81)return!0;const n=Math.floor(o/9),u=o%9;if(i[n][u]!==0)return E(i,r,o+1);const l=G(r,[1,2,3,4,5,6,7,8,9]);for(const e of l)if(se(i,n,u,e)){if(i[n][u]=e,E(i,r,o+1))return!0;i[n][u]=0}return!1}function ie(i,r,o){const n=i.map(l=>[...l]),u=G(r,Array.from({length:81},(l,e)=>e));for(const l of u){const e=Math.floor(l/9),t=l%9,c=n[e][t];if(n[e][t]=0,re(n,2)!=="unique"&&(n[e][t]=c),n.flat().filter(f=>f!==0).length<=o)break}return n}async function ue(i){const o=(await ee(Object.assign({"../data/bank/easy.json":()=>x(()=>import("./Cdf7bSM1.js"),[],import.meta.url),"../data/bank/expert.json":()=>x(()=>import("./bQ4ZPnbs.js"),[],import.meta.url),"../data/bank/hard.json":()=>x(()=>import("./DiHkrW1l.js"),[],import.meta.url),"../data/bank/normal.json":()=>x(()=>import("./BKPcU9vJ.js"),[],import.meta.url),"../data/bank/oni.json":()=>x(()=>import("./DEojRT7t.js"),[],import.meta.url)}),`../data/bank/${i}.json`,4)).default,n="bank",u=o[O(N(L()),o.length)],l=u.map(e=>e.map(t=>t!==0));return{grid:u,givens:l,seed:n,difficulty:i,rating:0}}const ce={easy:40,normal:35,hard:30,expert:25,oni:22};async function fe(i){const r=Date.now(),o=L(),n=N(o),u=ae();E(u,n);const l=ce[i],e=ie(u,n,l),t=oe(e,le(i));if(t.status!=="solved"||Date.now()-r>2500)return await ue(i);const c=e.map(a=>a.map(f=>f!==0));return{grid:e,givens:c,seed:o,difficulty:i,rating:t.rating}}const de={class:"flex gap-4"},ve={class:"relative",style:{width:"min(92vw,560px)",height:"min(92vw,560px)"}},be={class:"grid grid-cols-9 grid-rows-9 w-full h-full"},pe=["onClick"],ge={class:"flex flex-col items-center gap-4"},he={class:"grid grid-cols-3 gap-2"},ye=["onClick"],me=R({__name:"SudokuBoard",props:{difficulty:{},showErrors:{type:Boolean}},emits:["new"],setup(i,{expose:r,emit:o}){const n=i,u=o;function l(){return Array.from({length:9},()=>Array(9).fill(0))}const e=y(null),t=y(l()),c=y([]),a=y(null),f=y([]),p=y([]),g=y(w(t.value));async function M(){const s=await fe(n.difficulty);e.value=s,t.value=s.grid.map(d=>[...d]),c.value=s.givens.map(d=>[...d]),g.value=w(t.value),a.value=null,f.value=[],p.value=[],u("new",s)}H(()=>n.difficulty,()=>{M()}),r({newGame:M});function U(s,d){a.value={r:s,c:d}}function D(s){if(!a.value)return;const{r:d,c:v}=a.value;if(c.value[d][v]||!q(t.value,d,v,s))return;const h=t.value[d][v];t.value[d][v]=s,f.value.push({r:d,c:v,prev:h,next:s}),p.value=[],g.value=w(t.value)}function V(){if(!a.value)return;const{r:s,c:d}=a.value;if(c.value[s][d])return;const v=t.value[s][d];v!==0&&(t.value[s][d]=0,f.value.push({r:s,c:d,prev:v,next:0}),p.value=[],g.value=w(t.value))}function z(){const s=f.value.pop();s&&(t.value[s.r][s.c]=s.prev,p.value.push(s),g.value=w(t.value))}function $(){const s=p.value.pop();s&&(t.value[s.r][s.c]=s.next,f.value.push(s),g.value=w(t.value))}function F(s){if(!a.value)return;const{r:d,c:v}=a.value;s.key>="1"&&s.key<="9"?D(parseInt(s.key)):s.key==="0"||s.key==="Backspace"?V():s.key==="ArrowUp"||s.key==="w"||s.key==="W"?a.value={r:(d+8)%9,c:v}:s.key==="ArrowDown"||s.key==="s"||s.key==="S"?a.value={r:(d+1)%9,c:v}:s.key==="ArrowLeft"||s.key==="a"||s.key==="A"?a.value={r:d,c:(v+8)%9}:s.key==="ArrowRight"||s.key==="d"||s.key==="D"?a.value={r:d,c:(v+1)%9}:(s.ctrlKey||s.metaKey)&&s.key==="z"?z():(s.ctrlKey||s.metaKey)&&(s.key==="y"||s.shiftKey&&s.key==="Z")&&$()}return W(()=>M()),(s,d)=>(_(),k("div",{class:"inline-block",onKeydown:d[0]||(d[0]=Z(J(()=>{},["prevent"]),["tab"])),onKeydownCapture:F,tabindex:"0"},[b("div",de,[b("div",ve,[b("div",be,[(_(!0),k(A,null,C(t.value,(v,h)=>(_(),k(A,{key:h},[(_(!0),k(A,null,C(v,(S,m)=>{var T,B;return _(),k("button",{key:m,onClick:Ce=>U(h,m),class:I(["flex items-center justify-center select-none text-lg",(Math.floor(h/3)+Math.floor(m/3))%2===0?"bg-[var(--surface-2)]":"bg-[var(--surface)]",h===0?"border-t-4 border-t-[var(--fg)]":"",m===0?"border-l-4 border-l-[var(--fg)]":"",(h+1)%3===0?"border-b-4 border-b-[var(--fg)]":"border-b border-b-[var(--border)]",(m+1)%3===0?"border-r-4 border-r-[var(--fg)]":"border-r border-r-[var(--border)]",((T=a.value)==null?void 0:T.r)===h&&((B=a.value)==null?void 0:B.c)===m?"bg-yellow-200 dark:bg-yellow-600":a.value&&(a.value.r===h||a.value.c===m)?"bg-yellow-100 dark:bg-yellow-700":"",c.value[h][m]?"font-bold":"",n.showErrors&&g.value[h][m]?"bg-red-200 dark:bg-red-700":"",a.value&&t.value[a.value.r][a.value.c]!==0&&t.value[a.value.r][a.value.c]===S?"bg-blue-100 dark:bg-blue-700":""])},j(S||""),11,pe)}),128))],64))),128))])]),b("div",ge,[b("div",{class:"flex flex-col gap-2"},[b("button",{class:"p-2 bg-[var(--surface)] border border-[var(--border)] rounded w-12 h-12",onClick:V},"消"),b("button",{class:"p-2 bg-[var(--surface)] border border-[var(--border)] rounded w-12 h-12",onClick:z},"戻す"),b("button",{class:"p-2 bg-[var(--surface)] border border-[var(--border)] rounded w-12 h-12",onClick:$},"やり直し")]),b("div",he,[(_(),k(A,null,C(9,v=>b("button",{key:v,class:"p-2 bg-[var(--surface)] border border-[var(--border)] rounded w-12 h-12 flex items-center justify-center",onClick:h=>D(v)},j(v),9,ye)),64))]),b("button",{class:"p-2 bg-blue-500 dark:bg-blue-600 text-white border border-[var(--border)] rounded w-full",onClick:M},"新規ゲーム")])])],32))}}),ke={class:"min-h-screen p-4 flex flex-col items-center justify-center gap-4"},_e={class:"flex flex-wrap gap-2 items-center justify-center"},we={class:"flex flex-wrap gap-2"},xe=["onClick"],Ae={class:"flex items-center gap-1"},Me={class:"text-sm flex items-center gap-1"},Ee=R({__name:"sudoku",setup(i){const r=y("easy"),o=y(!0),n=y(""),u=[{value:"easy",label:"やさしい"},{value:"normal",label:"ふつう"},{value:"hard",label:"むずかしい"},{value:"expert",label:"エキスパート"},{value:"oni",label:"鬼"}];function l(c){n.value=c.seed}function e(){const c=document.documentElement,a=c.getAttribute("data-theme");c.setAttribute("data-theme",a==="dark"?"light":"dark")}async function t(){await navigator.clipboard.writeText(n.value)}return(c,a)=>(_(),k("div",ke,[b("div",_e,[b("div",we,[(_(),k(A,null,C(u,f=>b("button",{key:f.value,class:I(["px-2 py-1 border border-[var(--border)] rounded",f.value===r.value?"bg-blue-500 text-white dark:bg-blue-600":"bg-[var(--surface)]"]),onClick:p=>r.value=f.value},j(f.label),11,xe)),64))]),b("label",Ae,[X(b("input",{type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=f=>o.value=f)},null,512),[[Y,o.value]]),a[1]||(a[1]=K(" エラーハイライト "))]),b("button",{class:"border border-[var(--border)] p-1 bg-[var(--surface)]",onClick:e},"テーマ切替"),b("div",Me,[K(" Seed: "+j(n.value)+" ",1),b("button",{class:"border border-[var(--border)] px-1 bg-[var(--surface)]",onClick:t},"コピー")])]),Q(me,{difficulty:r.value,"show-errors":o.value,onNew:l},null,8,["difficulty","show-errors"])]))}});export{Ee as default};
