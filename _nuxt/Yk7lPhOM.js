import{e as $,M as k,N as B,h as C,z as I,O as M,c as n,J as _,a as c,t as m,F as h,C as b,o as r,i as S}from"./Bfj_vXhI.js";import{u as F}from"./DwHfJ3QA.js";import"./wSbNHcIL.js";const N={key:0,class:"p-4"},E={class:"text-2xl mb-4"},J={class:"flex gap-4 overflow-x-auto"},L={class:"font-bold mb-2"},O=["onDrop"],P=["onDragstart"],T={key:1,class:"p-4"},G=$({__name:"[id]",async setup(U){let l,f;const v=k(),{data:e}=([l,f]=B(()=>F(`/api/boards/${v.params.id}`,"$PyGKqM0HTI")),l=await l,f(),l),u=C(null),y=async()=>{e.value&&await $fetch(`/api/boards/${e.value.id}`,{method:"PUT",body:e.value})},w=(a,o)=>{u.value={columnId:a,cardId:o}},x=a=>{if(!u.value||!e.value)return;const{columnId:o,cardId:s}=u.value,t=e.value.columns.find(i=>i.id===o),p=e.value.columns.find(i=>i.id===a);if(!t||!p)return;const g=t.cards.findIndex(i=>i.id===s);if(g===-1)return;const[D]=t.cards.splice(g,1);p.cards.push(D),u.value=null,y()};let d=null;return I(()=>{d=new EventSource(`/api/boards/${v.params.id}/stream`),d.onmessage=a=>{e.value=JSON.parse(a.data)}}),M(()=>{d==null||d.close()}),(a,o)=>_(e)?(r(),n("div",N,[c("h1",E,m(_(e).name),1),c("div",J,[(r(!0),n(h,null,b(_(e).columns,s=>(r(),n("div",{key:s.id,class:"w-64 bg-gray-100 p-2 rounded"},[c("h2",L,m(s.name),1),c("ul",{onDragover:o[0]||(o[0]=S(()=>{},["prevent"])),onDrop:t=>x(s.id)},[(r(!0),n(h,null,b(s.cards,t=>(r(),n("li",{key:t.id,class:"bg-white p-2 mb-2 rounded shadow",draggable:"true",onDragstart:p=>w(s.id,t.id)},m(t.title),41,P))),128))],40,O)]))),128))])])):(r(),n("div",T,"Loading..."))}});export{G as default};
