import{_ as w,e as I,h as y,z as H,p as W,A as Z,c as g,B as J,j as Q,a as v,l as X,F as C,C as M,o as k,D as E,t as j,b as Y,k as ee,d as P,E as te}from"./BmSVUKx7.js";const re=(i,r,o)=>{const n=i[r];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((u,l)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(l.bind(null,new Error("Unknown variable dynamic import: "+r+(r.split("/").length!==o?". Note that variables only represent file names one level deep.":""))))})};function N(){const i=new Uint32Array(4);return crypto.getRandomValues(i),Array.from(i).map(r=>r.toString(36)).join("")}function L(i){let r=0;for(const o of i)r=r*31+o.charCodeAt(0)>>>0;return r===0&&(r=1),()=>(r^=r<<13,r^=r>>>17,r^=r<<5,r>>>0)}function O(i,r){return i()%r}function G(i,r){for(let o=r.length-1;o>0;o--){const n=O(i,o+1);[r[o],r[n]]=[r[n],r[o]]}return r}function ne(i,r,o,n){for(let e=0;e<9;e++)if(i[r][e]===n||i[e][o]===n)return!1;const u=Math.floor(r/3)*3,l=Math.floor(o/3)*3;for(let e=0;e<3;e++)for(let t=0;t<3;t++)if(i[u+e][l+t]===n)return!1;return!0}function oe(i,r=2){const o=i.map(l=>[...l]);let n=0;const u=(l=0)=>{if(n>=r)return;if(l===81){n++;return}const e=Math.floor(l/9),t=l%9;if(o[e][t]!==0){u(l+1);return}for(let c=1;c<=9&&n<r;c++)ne(o,e,t,c)&&(o[e][t]=c,u(l+1));o[e][t]=0};return u(),n===0?"none":n===1?"unique":"multiple"}function le(){return Array.from({length:9},()=>Array(9).fill(!1))}function x(i){const r=le(),o=Array.from({length:9},()=>Array(10).fill(-1)),n=Array.from({length:9},()=>Array(10).fill(-1)),u=Array.from({length:9},()=>Array(10).fill(-1));for(let l=0;l<9;l++)for(let e=0;e<9;e++){const t=i[l][e];if(t===0)continue;const c=Math.floor(l/3)*3+Math.floor(e/3);if(o[l][t]!==-1?r[l][e]=r[l][o[l][t]]=!0:o[l][t]=e,n[e][t]!==-1?r[l][e]=r[n[e][t]][e]=!0:n[e][t]=l,u[c][t]!==-1){const s=Math.floor(u[c][t]/9),f=u[c][t]%9;r[l][e]=r[s][f]=!0}else u[c][t]=l*9+e}return r}function ae(i,r,o,n){for(let e=0;e<9;e++)if(i[r][e]===n||i[e][o]===n)return!1;const u=Math.floor(r/3)*3,l=Math.floor(o/3)*3;for(let e=0;e<3;e++)for(let t=0;t<3;t++)if(i[u+e][l+t]===n)return!1;return!0}function R(i,r,o){const n=[];for(let u=1;u<=9;u++)ae(i,r,o,u)&&n.push(u);return n}function se(i,r){const o=i.map(l=>[...l]);let n=0;for(;;){let l=!1;for(let e=0;e<9;e++)for(let t=0;t<9;t++){if(o[e][t]!==0)continue;const c=R(o,e,t);c.length===1&&r.includes("naked-single")&&(o[e][t]=c[0],n+=1,l=!0)}if(!l){if(r.includes("hidden-single")){for(let e=0;e<27&&!l;e++){const t=[];if(e<9)for(let s=0;s<9;s++)t.push({r:e,c:s});else if(e<18)for(let s=0;s<9;s++)t.push({r:s,c:e-9});else{const s=Math.floor((e-18)/3)*3,f=(e-18)%3*3;for(let p=0;p<3;p++)for(let m=0;m<3;m++)t.push({r:s+p,c:f+m})}const c=Array.from({length:10},()=>[]);for(const{r:s,c:f}of t)if(o[s][f]===0)for(const p of R(o,s,f))c[p].push(s*9+f);for(let s=1;s<=9;s++)if(c[s].length===1){const f=c[s][0],p=Math.floor(f/9),m=f%9;o[p][m]=s,n+=1,l=!0;break}}if(l)continue}break}}return{status:o.every(l=>l.every(e=>e!==0))?"solved":"stuck",rating:n}}function ie(i){switch(i){case"easy":return["naked-single","hidden-single"];case"normal":return["naked-single","hidden-single","locked","naked-pair"];case"hard":return["naked-single","hidden-single","locked","naked-pair","hidden-pair","x-wing"];case"expert":return["naked-single","hidden-single","locked","naked-pair","hidden-pair","x-wing","xy-wing"];case"oni":return["naked-single","hidden-single","locked","naked-pair","hidden-pair","x-wing","xy-wing","swordfish"];default:return["naked-single","hidden-single"]}}function ue(){return Array.from({length:9},()=>Array(9).fill(0))}function ce(i,r,o,n){for(let e=0;e<9;e++)if(i[r][e]===n||i[e][o]===n)return!1;const u=Math.floor(r/3)*3,l=Math.floor(o/3)*3;for(let e=0;e<3;e++)for(let t=0;t<3;t++)if(i[u+e][l+t]===n)return!1;return!0}function D(i,r,o=0){if(o===81)return!0;const n=Math.floor(o/9),u=o%9;if(i[n][u]!==0)return D(i,r,o+1);const l=G(r,[1,2,3,4,5,6,7,8,9]);for(const e of l)if(ce(i,n,u,e)){if(i[n][u]=e,D(i,r,o+1))return!0;i[n][u]=0}return!1}function fe(i,r,o){const n=i.map(l=>[...l]),u=G(r,Array.from({length:81},(l,e)=>e));for(const l of u){const e=Math.floor(l/9),t=l%9,c=n[e][t];if(n[e][t]=0,oe(n,2)!=="unique"&&(n[e][t]=c),n.flat().filter(f=>f!==0).length<=o)break}return n}async function de(i){const o=(await re(Object.assign({"../data/bank/easy.json":()=>w(()=>import("./Cdf7bSM1.js"),[],import.meta.url),"../data/bank/expert.json":()=>w(()=>import("./bQ4ZPnbs.js"),[],import.meta.url),"../data/bank/hard.json":()=>w(()=>import("./DiHkrW1l.js"),[],import.meta.url),"../data/bank/normal.json":()=>w(()=>import("./BKPcU9vJ.js"),[],import.meta.url),"../data/bank/oni.json":()=>w(()=>import("./DEojRT7t.js"),[],import.meta.url)}),`../data/bank/${i}.json`,4)).default,n="bank",u=o[O(L(N()),o.length)],l=u.map(e=>e.map(t=>t!==0));return{grid:u,givens:l,seed:n,difficulty:i,rating:0}}const ve={easy:40,normal:35,hard:30,expert:25,oni:22};async function be(i){const r=Date.now(),o=N(),n=L(o),u=ue();D(u,n);const l=ve[i],e=fe(u,n,l),t=se(e,ie(i));if(t.status!=="solved"||Date.now()-r>2500)return await de(i);const c=e.map(s=>s.map(f=>f!==0));return{grid:e,givens:c,seed:o,difficulty:i,rating:t.rating}}const pe={class:"flex gap-4"},me={class:"relative",style:{width:"min(92vw,560px)",height:"min(92vw,560px)"}},he={class:"w-full h-full border-[3px] border-[var(--muted)] border-collapse table-fixed"},ye=["onClick"],ge={key:0,class:"absolute inset-0 flex items-center justify-center bg-black/20 text-4xl font-bold text-green-600"},ke={class:"flex flex-col items-center gap-4"},_e={class:"grid grid-cols-3 gap-2"},xe=["onClick"],we=I({__name:"SudokuBoard",props:{difficulty:{},showErrors:{type:Boolean}},emits:["new"],setup(i,{expose:r,emit:o}){const n=i,u=o;function l(){return Array.from({length:9},()=>Array(9).fill(0))}const e=y(null),t=y(l()),c=y([]),s=y(null),f=y([]),p=y([]),m=y(x(t.value)),q=H(()=>t.value.every(a=>a.every(d=>d!==0)));async function A(){const a=await be(n.difficulty);e.value=a,t.value=a.grid.map(d=>[...d]),c.value=a.givens.map(d=>[...d]),m.value=x(t.value),s.value=null,f.value=[],p.value=[],u("new",a)}W(()=>n.difficulty,()=>{A()}),r({newGame:A});function U(a,d){s.value={r:a,c:d}}function V(a){if(!s.value)return;const{r:d,c:b}=s.value;if(c.value[d][b])return;const h=t.value[d][b];t.value[d][b]=a,f.value.push({r:d,c:b,prev:h,next:a}),p.value=[],m.value=x(t.value)}function z(){if(!s.value)return;const{r:a,c:d}=s.value;if(c.value[a][d])return;const b=t.value[a][d];b!==0&&(t.value[a][d]=0,f.value.push({r:a,c:d,prev:b,next:0}),p.value=[],m.value=x(t.value))}function $(){const a=f.value.pop();a&&(t.value[a.r][a.c]=a.prev,p.value.push(a),m.value=x(t.value))}function S(){const a=p.value.pop();a&&(t.value[a.r][a.c]=a.next,f.value.push(a),m.value=x(t.value))}function F(a){if(!s.value)return;const{r:d,c:b}=s.value;a.key>="1"&&a.key<="9"?V(parseInt(a.key)):a.key==="0"||a.key==="Backspace"?z():a.key==="ArrowUp"||a.key==="w"||a.key==="W"?s.value={r:(d+8)%9,c:b}:a.key==="ArrowDown"||a.key==="s"||a.key==="S"?s.value={r:(d+1)%9,c:b}:a.key==="ArrowLeft"||a.key==="a"||a.key==="A"?s.value={r:d,c:(b+8)%9}:a.key==="ArrowRight"||a.key==="d"||a.key==="D"?s.value={r:d,c:(b+1)%9}:(a.ctrlKey||a.metaKey)&&a.key==="z"?$():(a.ctrlKey||a.metaKey)&&(a.key==="y"||a.shiftKey&&a.key==="Z")&&S()}return Z(()=>A()),(a,d)=>(k(),g("div",{class:"inline-block",onKeydown:d[0]||(d[0]=J(Q(()=>{},["prevent"]),["tab"])),onKeydownCapture:F,tabindex:"0"},[v("div",pe,[v("div",me,[v("table",he,[v("tbody",null,[(k(!0),g(C,null,M(t.value,(b,h)=>(k(),g("tr",{key:h},[(k(!0),g(C,null,M(b,(T,_)=>{var B,K;return k(),g("td",{key:_,class:E(["p-0",(h+1)%3===0?"border-b-[3px] border-b-[var(--fg)]":"border-b border-b-[var(--border)]",(_+1)%3===0?"border-r-[3px] border-r-[var(--fg)]":"border-r border-r-[var(--border)]"])},[v("button",{onClick:Ve=>U(h,_),class:E(["w-full h-full flex items-center justify-center select-none text-lg bg-[var(--surface)] border-none p-0",[s.value&&(s.value.r===h||s.value.c===_)?"bg-blue-50 dark:bg-blue-900":"",((B=s.value)==null?void 0:B.r)===h&&((K=s.value)==null?void 0:K.c)===_?"bg-blue-200 dark:bg-blue-700":"",c.value[h][_]?"font-bold":"",s.value&&t.value[s.value.r][s.value.c]!==0&&t.value[s.value.r][s.value.c]===T?"bg-blue-100 dark:bg-blue-700":"",n.showErrors&&m.value[h][_]?"bg-red-100 dark:bg-red-900 text-red-600 dark:text-red-400":""]])},j(T||""),11,ye)],2)}),128))]))),128))])]),q.value?(k(),g("div",ge," Done! ")):X("",!0)]),v("div",ke,[v("div",{class:"flex flex-col gap-2"},[v("button",{class:"p-2 bg-[var(--surface)] border border-[var(--border)] rounded w-12 h-12",onClick:z},"消"),v("button",{class:"p-2 bg-[var(--surface)] border border-[var(--border)] rounded w-12 h-12",onClick:$},"戻す"),v("button",{class:"p-2 bg-[var(--surface)] border border-[var(--border)] rounded w-12 h-12",onClick:S},"やり直し")]),v("div",_e,[(k(),g(C,null,M(9,b=>v("button",{key:b,class:"p-2 bg-[var(--surface)] border border-[var(--border)] rounded w-12 h-12 flex items-center justify-center",onClick:h=>V(b)},j(b),9,xe)),64))]),v("button",{class:"p-2 bg-blue-500 dark:bg-blue-600 text-white border border-[var(--border)] rounded w-full",onClick:A},"新規ゲーム")])])],32))}}),Ae={class:"min-h-screen p-4 flex flex-col items-center justify-center gap-4"},Ce={class:"flex flex-wrap gap-2 items-center justify-center"},Me={class:"flex flex-wrap gap-2"},je=["onClick"],Ee={class:"flex items-center gap-1"},De={class:"text-sm flex items-center gap-1"},$e=I({__name:"sudoku",setup(i){const r=y("easy"),o=y(!0),n=y(""),u=[{value:"easy",label:"やさしい"},{value:"normal",label:"ふつう"},{value:"hard",label:"むずかしい"},{value:"expert",label:"エキスパート"},{value:"oni",label:"鬼"}];function l(c){n.value=c.seed}function e(){const c=document.documentElement,s=c.getAttribute("data-theme");c.setAttribute("data-theme",s==="dark"?"light":"dark")}async function t(){await navigator.clipboard.writeText(n.value)}return(c,s)=>(k(),g("div",Ae,[v("div",Ce,[v("div",Me,[(k(),g(C,null,M(u,f=>v("button",{key:f.value,class:E(["px-2 py-1 border border-[var(--border)] rounded",f.value===r.value?"bg-blue-500 text-white dark:bg-blue-600":"bg-[var(--surface)]"]),onClick:p=>r.value=f.value},j(f.label),11,je)),64))]),v("label",Ee,[ee(v("input",{type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=f=>o.value=f)},null,512),[[te,o.value]]),s[1]||(s[1]=P(" エラーハイライト "))]),v("button",{class:"border border-[var(--border)] p-1 bg-[var(--surface)]",onClick:e},"テーマ切替"),v("div",De,[P(" Seed: "+j(n.value)+" ",1),v("button",{class:"border border-[var(--border)] px-1 bg-[var(--surface)]",onClick:t},"コピー")])]),Y(we,{difficulty:r.value,"show-errors":o.value,onNew:l},null,8,["difficulty","show-errors"])]))}});export{$e as default};
